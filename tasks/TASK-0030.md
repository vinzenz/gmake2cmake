<task id="TASK-0030">
<summary>Handle recursive Make subdirectory traversal.</summary>
<scope>
- Enhance MakefileDiscoverer to detect $(MAKE) -C subdir patterns.
- Build complete directory traversal graph including recursive makes.
- Handle both -C and -f flags in recursive make invocations.
- Support variable substitution in directory paths.
- Detect and report recursive make cycles.</scope>
<developer>
- Parse $(MAKE) invocations in rule commands during discovery.
- Extract -C directory and -f makefile arguments.
- Resolve relative paths from current makefile directory.
- Add subdir edges to IncludeGraph with traversal order.
- Implement cycle detection for recursive directory traversal.</developer>
<qe>
- Test multi-level recursive make projects.
- Verify correct directory resolution with relative paths.
- Test variable substitution in -C arguments.
- Validate cycle detection in recursive makes.
- Test mixed include and recursive patterns.</qe>
<reviewer>
- Check recursive detection doesn't over-match.
- Verify path resolution handles edge cases.
- Ensure traversal order matches Make behavior.
- Validate diagnostics for recursive issues.</reviewer>
<tests>
- Commands: `pytest -q tests/discovery/test_recursive_make.py`.</tests>
</task>