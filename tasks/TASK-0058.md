<task id="TASK-0058">
<summary>Security hardening for path operations and command execution</summary>
<scope>
- Components: fs.py, path_utils.py, make/evaluator.py, make/discovery.py, config.py
- Focus on preventing path traversal, command injection, and resource exhaustion attacks
</scope>
<developer>
- Implement path traversal validation using pathlib.Path.resolve()
- Add checks that resolved paths are within project root
- Create safe path joining functions that prevent escaping
- Sanitize all user-provided file paths and names
- Remove any use of shell=True in subprocess calls
- Add input validation for command arguments
- Implement file size limits for parsing operations
- Create sandbox directory for file operations
- Add allowlist for acceptable file extensions
</developer>
<qe>
- Test path traversal attempts with ../ sequences
- Verify symlink attacks are prevented
- Test command injection with shell metacharacters
- Validate file operations stay within sandbox
- Test resource exhaustion with large files
- Verify error handling for invalid paths
</qe>
<reviewer>
- Confirm all path operations use safe validation
- Verify no shell=True or os.system() usage
- Check that user inputs are properly sanitized
- Ensure sandbox boundaries are enforced
- Validate security tests cover OWASP top 10 relevant items
</reviewer>
<tests>
- Security test suite for path traversal (CWE-22)
- Command injection tests (CWE-78)
- File path manipulation tests (CWE-73)
- Symlink attack prevention tests
- Resource exhaustion tests
- Fuzzing tests for path operations
</tests>
</task>