<task id="TASK-0049">
<summary>Add context managers for safer resource handling.</summary>
<scope>
- Introduce context managers for pipeline execution and atomic writes to ensure cleanup on errors.
- Provide optional batch/atomic write helpers in fs and use them in CLI write paths.</scope>
<developer>
- Add pipeline context wrapper for dry-run/temp outputs; add atomic write helper in `gmake2cmake/fs.py` (or adapter).
- Update CLI/emitter write flows to adopt new helpers where appropriate without changing behavior.</developer>
<qe>
- Add tests verifying temporary dirs are cleaned, atomic writes are committed/rolled back correctly, and no leaked files remain after failures.</qe>
<reviewer>
- Ensure new helpers are optional, donâ€™t break existing fs adapters, and maintain deterministic outputs.</reviewer>
<tests>
- Commands: `ruff check . && pytest -q tests/test_cli.py tests/test_discovery.py`.</tests>
</task>
