<task id="TASK-0074">
<summary>Parse GNU make database dump into structured targets/variables</summary>
<scope>
- Components: introspection parser module, data models for parsed targets/variables/commands
- Input: stdout from `make -pn` (or equivalent) captured by the runner
</scope>
<developer>
- Implement parser to extract declared targets, prerequisites, and final command lines from the make database dump; capture fully expanded variable values (CFLAGS, CXXFLAGS, LDFLAGS, CPPFLAGS, LDLIBS).
- Normalize paths to posix, handle phony/special targets, and filter out built-in rules.
- Provide stable data structures consumable by IRBuilder (e.g., mapping target -> deps/commands/flags).
- Add heuristics to associate commands with compilation vs linking and annotate with language where possible.
- Document assumptions and limitations (e.g., ignores pattern rules in dump unless fully instantiated).
</developer>
<qe>
- Add focused unit tests with canned `make -pn` snippets to cover variables, targets with multiple prerequisites, phony targets, and commands.
- Validate parser strips built-ins and produces deterministic ordering.
- Include negative tests for malformed dumps to ensure graceful diagnostics.
</qe>
<reviewer>
- Check parser correctness against GNU make output format and robustness to whitespace/continuations.
- Ensure type hints and data contracts are clear; no leakage of built-in rules.
- Verify performance on large dumps (no quadratic behaviors).
</reviewer>
<tests>
- pytest tests/introspection/test_parser.py
- pytest -k "introspection and dump"
- Optional: golden fixture generated from a small sample Makefile
</tests>
</task>
