<task id="TASK-0056">
<summary>Add comprehensive type hints throughout the codebase</summary>
<scope>
- Components: All Python modules, especially fs.py, ir/builder.py, make/evaluator.py, cache.py, parallel.py
- Focus on adding complete type hints for all public APIs and complex data structures
</scope>
<developer>
- Add return type hints to all functions missing them
- Replace generic Dict, List with specific type parameters (e.g., Dict[str, List[str]])
- Create type aliases for complex repeated types using typing.TypeAlias
- Ensure all Protocol methods have complete type signatures
- Use Optional[] explicitly instead of | None for Python 3.11 compatibility
- Add type hints for callback functions and complex lambdas
- Create py.typed marker file for PEP 561 compliance
</developer>
<qe>
- Run mypy in strict mode and verify no errors
- Test that type hints are consistent with runtime behavior
- Verify IDE autocompletion works correctly
- Validate that complex generic types are properly specified
- Ensure type stubs are generated correctly
</qe>
<reviewer>
- Check all public functions have return type hints
- Verify type aliases improve readability
- Confirm Protocol classes are fully typed
- Validate generic type parameters are specific enough
- Ensure consistency in Optional vs Union[X, None] usage
</reviewer>
<tests>
- Run mypy --strict on entire codebase
- Verify no runtime type errors with pytest
- Test that type hints match actual return values
- Validate Protocol implementations conform to interfaces
- Check py.typed file is properly placed
</tests>
</task>