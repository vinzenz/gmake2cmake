<task id="TASK-0023">
<summary>Implement target dependency cycle detection.</summary>
<scope>
- Add cycle detection for target dependencies in IRBuilder.attach_dependencies.
- Detect direct and transitive circular dependencies between targets.
- Emit ERROR diagnostic IR_DEPENDENCY_CYCLE with full cycle path.
- Break cycles safely to allow partial IR generation.
- Track and report all cycles, not just first one found.</scope>
<developer>
- Implement DFS-based cycle detection on target dependency graph.
- Collect all strongly connected components with cycles.
- Generate clear diagnostic messages showing cycle paths.
- Mark affected targets with reduced dependencies to break cycles.
- Ensure deterministic cycle detection and reporting order.</developer>
<qe>
- Test detection of simple A->B->A cycles.
- Test complex multi-target cycles.
- Verify all cycles reported, not just first.
- Test IR still generated with cycles broken.
- Validate diagnostic messages clarity.</qe>
<reviewer>
- Check algorithm correctly identifies all cycles.
- Verify cycle breaking doesn't lose valid dependencies.
- Ensure performance acceptable for large dependency graphs.
- Validate diagnostic information sufficient for debugging.</reviewer>
<tests>
- Commands: `pytest -q tests/ir/test_dependency_cycles.py`.</tests>
</task>